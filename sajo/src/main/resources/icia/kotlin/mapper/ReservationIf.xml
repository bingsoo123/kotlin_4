<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="icia.kotlin.mapper.ReservationIf">
	<!-- QUERY에 포함된 문자중에 <> & || 등 이 있다면 XML 파싱을 하지 않도록 -->
	<select id="getMovieList" resultType="icia.kotlin.beans.Movie">
		<![CDATA[
		SELECT MV_CODE AS  MVCODE, MV_NAME AS MVNAME, MV_GRADE AS MVGRADE, MV_STATUS AS MVSTATUS, MV_IMAGE AS MVIMAGE, MV_COMMENTS AS MVCOMMENTS FROM MV WHERE MV_STATUS != 'B' 
		]]>
	</select>
	<select id="getMovieDetail" resultType="icia.kotlin.beans.Movie">
		SELECT MV_CODE AS  MVCODE, MV_NAME AS MVNAME, MV_GRADE AS MVGRADE, MV_STATUS AS MVSTATUS, MV_IMAGE AS MVIMAGE, MV_COMMENTS AS MVCOMMENTS FROM MV WHERE MV_CODE=#{mvCode}
	</select>
	<select id="getScreen" resultType="icia.kotlin.beans.Movie">
      SELECT MVCODE , MVNAME , MVGRADE , SCREEN AS MVSCREEN, TO_CHAR(MVTIME,'HH24MI') AS MVTIME FROM MVINFO WHERE TO_CHAR(MVTIME,'YYYY-MM-DD') = #{mvDate} AND MVCODE=#{mvCode}  
   </select>
   
   <select id="isMovie" resultType="int">
      SELECT COUNT(*) FROM SM WHERE SI_MVCODE=#{mvCode} AND TO_CHAR(SI_DATETIME,'YYYY-MM-DD')=#{mvDate}
   </select>
	<select id="getScreening" resultType="icia.kotlin.beans.Movie">
		<![CDATA[
		SELECT MVCODE , MVNAME , MVGRADE , SCREEN AS MVSCREEN, TO_CHAR(MVTIME,'HH24MI') AS MVTIME FROM MVINFO WHERE TO_CHAR(MVTIME,'YYYY-MM-DD') = #{mvDate} AND MVCODE=#{mvCode}
		]]>
	</select>
	</mapper>